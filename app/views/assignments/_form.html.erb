<div class="form-wrapper">
  <div class="form-container">
    <div class="form-card">
      <%= form_with(model: assignment, local: true) do |form| %>
        <%= form.hidden_field :classroom_id %>

        <div class="mb-3">
          <%= form.label :title, class: "form-label" %>
          <%= form.text_field :title, class: "form-control", placeholder: "Enter assignment title" %>
        </div>

        <div class="mb-3">
          <%= form.label :due_date, class: "form-label" %>
          <%= form.date_field :due_date, class: "form-control" %>
        </div>

        <div class="mb-3">
          <%= form.label :status, class: "form-label" %>
          <%= form.select :status, ["Not started", "In progress", "Completed"], {}, class: "form-select" %>
        </div>

        <div class="mb-3">
          <%= form.label :progress, "Progress (%)", class: "form-label" %>
          <%= form.range_field :progress, in: 0..100, class: "form-range", id: "progressRange" %>
          <output for="progressRange" class="form-text"><%= assignment.progress || 0 %>%</output>
        </div>

        <div class="mb-3">
          <%= form.label :description, class: "form-label" %>
          <%= form.text_area :description, class: "form-control", rows: 4, placeholder: "Add notes or description for this assignment (optional)" %>
        </div>

        <div class="d-flex gap-2">
          <%= form.submit class: "btn btn-primary" %>
          <%= link_to "Cancel", classroom_path(assignment.classroom), class: "btn btn-secondary" %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<script>
  const progressRange = document.getElementById('progressRange');
  const progressOutput = document.querySelector('output[for="progressRange"]');
  const statusSelect = document.getElementById('assignment_status');
  
  if (progressRange && progressOutput) {
    progressRange.addEventListener('input', function() {
      progressOutput.textContent = this.value + '%';
    });
  }
  
  // Automatically set progress to 0% when "Not started" is selected
  if (statusSelect && progressRange && progressOutput) {
    statusSelect.addEventListener('change', function() {
      if (this.value === 'Not started') {
        progressRange.value = 0;
        progressOutput.textContent = '0%';
      } else if (this.value === 'Completed') {
        progressRange.value = 100;
        progressOutput.textContent = '100%';
      }
    });
  }
</script>
