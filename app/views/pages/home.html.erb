<div class="text-center py-5">
  <h1 class="home-h1">Welcome to Assignment Tracker ğŸ“</h1>
  <p class="lead mb-4">Assignment Tracker helps you stay organized and never miss a deadline</p>
  
  <div class="row justify-content-center">
    <div class="col-md-10">
      <div class="card shadow home-card">
        <div class="card-body">
          <% if user_signed_in? %>
            <h3 class="mb-4">Your Assignment Calendar</h3>

            <div id="calendar"></div>

            <script>
              function initializeCalendar() {
                var calendarEl = document.getElementById('calendar');
                
                if (!calendarEl) return;
                
                var events = [
                  <% @assignments.each do |assignment| %>
                    {
                      title: '<%= j assignment.title %>',
                      start: '<%= assignment.due_date.strftime('%Y-%m-%d') %>',
                      url: '<%= assignment_path(assignment) %>',
                      backgroundColor: '#faebd7',
                      borderColor: '#d4a574',
                      textColor: '#000000'
                    },
                  <% end %>
                ];

                var calendar = new FullCalendar.Calendar(calendarEl, {
                  initialView: 'dayGridMonth',
                  headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: ''
                  },
                  events: events,
                  eventClick: function(info) {
                    info.jsEvent.preventDefault();
                    if (info.event.url) {
                      window.location.href = info.event.url;
                    }
                  },
                  height: 'auto',
                  contentHeight: 600
                });
                
                calendar.render();
              }

              // Initialize on both DOMContentLoaded and turbo:load
              document.addEventListener('DOMContentLoaded', initializeCalendar);
              document.addEventListener('turbo:load', initializeCalendar);
            </script>

            <% if @assignments.empty? %>
              <div class="text-center py-4 mt-3">
                <p class="text-muted">You haven't added any assignments yet.</p>
                <%= link_to "Add your first assignment", classrooms_path, class: "btn btn-success" %>
              </div>
            <% end %>
          <% else %>
            <h5 class="card-title">What Assignment Tracker does:</h5>
            <ul class="list-unstyled">
              <li>âœ… Track assignments by classroom</li>
              <li>âœ… User authentication with profile pictures</li>
              <li>âœ… Monitor assignment progress and status</li>
              <li>âœ… View deadlines in calendar format</li>
            </ul>
            
            <p class="text-muted">Get started by creating an account!</p>
            <%= link_to "Sign Up Now", new_user_registration_path, class: "btn btn-success btn-lg me-2" %>
            <%= link_to "Login", new_user_session_path, class: "btn btn-outline-primary btn-lg" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row mt-5">
  <div class="col-md-4">
    <div class="card home-card">
      <div class="card-body">
        <h5 class="card-title">ğŸ“š Assignments</h5>
        <p class="card-text">Keep track of all your assignments in one place.</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card home-card">
      <div class="card-body">
        <h5 class="card-title">ğŸ« Classrooms</h5>
        <p class="card-text">Organise assignments by class for better management.</p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card home-card">
      <div class="card-body">
        <h5 class="card-title">ğŸ“Š Progress</h5>
        <p class="card-text">See how you're doing with visual progress tracking.</p>
      </div>
    </div>
  </div>
</div>
